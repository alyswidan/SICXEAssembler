PALIND   START   0
extdef   RLOOP,RDREC
extref	 xyz,klm,ioi
FIRST    LDB     #1
CLOOP    +JSUB   ioi
         LDA     LENGTH
         COMP    #0
         JEQ     CLOOP
         LDT     #LENGTH
         SUBR    B,T
         +JSUB   CMPREC
LENGTH   RESW    1
.
. SUBROUTINE READ RECORD
.
RDREC    CLEAR   X
         CLEAR   A
         CLEAR   S
         +LDT    klm
RLOOP    TD      INPUT
         JEQ     RLOOP
         RD      INPUT
         COMPR   A,S
         JEQ     EXIT1
         STCH    BUFFER,X
         TIXR    T
         JLT     RLOOP
EXIT1    STX     LENGTH
SEWE	 EQU	 *
         RSUB
.
. SUBROUTINE COMPARE RECORD
.
	     org	 500
CMPREC   CLEAR   A
         COMPR   X,T
         JEQ     EXIT2
         JGT     EXIT2
         LDA     BUFFER,X
         LDS     BUFFER,X
         SUBR    B,T
         ADDR    B,X
         COMPR   A,S
         JEQ     CMPREC
         JLT     ERROR
         JGT     ERROR
EXIT2    LDA     #1
         STA     RESULT
.
INPUT    BYTE    12
ERROR    RSUB
RESULT   RESW    1
BUFFER   RESB    4096
ZZZZZ	 word    BUFFER-RLOOP-SEWE
equals	 equ	 klm-ioi
.
KELOA	CSECT
		SUBR    B,T
        ADDR    B,X
        COMPR   A,S
.KELOA	BASE	20

HISUKA	CSECT
		SUBR    B,T
        ADDR    B,X
        COMPR   A,S
.KELOA	BASE	20
		END	 FIRST